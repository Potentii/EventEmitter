"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _slicedToArray=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var s,o=e[Symbol.iterator]();!(n=(s=o.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,a=e}finally{try{!n&&o.return&&o.return()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),EventEmitter=function(){function e(){_classCallCheck(this,e),this._events=new Map,this._max_listeners=e.defaultMaxListeners}return _createClass(e,[{key:"_addListener",value:function(e,t,r){var n=this;if("function"!=typeof t)throw new TypeError("'callback' argument must be a function");return e=String(e),this.emit("newListener",e,t),this._events.has(e)?!function(){var i=n._events.get(e);r?i.push(t):i.unshift(t);var a=i.length;0!==n._max_listeners&&n._max_listeners!==1/0&&a>n._max_listeners&&setTimeout(function(){return console.warn("warning: possible EventEmitter memory leak detected. "+a+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.")},0)}():this._events.set(e,[t]),this}},{key:"on",value:function(e,t){return this._addListener(e,t,!0)}},{key:"addListener",value:function(e,t){return this._addListener(e,t,!0)}},{key:"prependListener",value:function(e,t){return this._addListener(e,t,!1)}},{key:"_wrapOnceCallback",value:function(e,t){var r={scope:this,fired:!1,wrapped_callback:void 0,callback:t},n=function(){if(this.scope.removeListener(e,n),!this.fired){this.fired=!0;for(var r=arguments.length,i=Array(r),a=0;a<r;a++)i[a]=arguments[a];t.call.apply(t,[this.scope].concat(i))}}.bind(r);return n.callback=t,r.wrapped_callback=n,n}},{key:"prependOnceListener",value:function(e,t){if("function"!=typeof t)throw new TypeError("'callback' argument must be a function");return e=String(e),this._addListener(e,this._wrapOnceCallback(e,t),!1)}},{key:"once",value:function(e,t){if("function"!=typeof t)throw new TypeError("'callback' argument must be a function");return e=String(e),this._addListener(e,this._wrapOnceCallback(e,t),!0)}},{key:"removeListener",value:function(e,t){if("function"!=typeof t)throw new TypeError("'callback' argument must be a function");if(e=String(e),this._events.has(e)){var r=this._events.get(e),n=r.findIndex(function(e){return e===t});n>=0&&(r.splice(n,1),this.emit("removeListener",e,t))}return this}},{key:"removeAllListeners",value:function(e){if(arguments.length){e=String(e);var t=this._events.get(e);this._events.delete(e);var r=!0,n=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value;this.emit("removeListener",e,o)}}catch(e){n=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw i}}}else{var l=new Map(this._events);this._events=new Map;var u=!0,c=!1,f=void 0;try{for(var v,h=l.entries()[Symbol.iterator]();!(u=(v=h.next()).done);u=!0){var y=_slicedToArray(v.value,2),d=y[0],m=y[1],p=!0,_=!1,b=void 0;try{for(var g,w=m[Symbol.iterator]();!(p=(g=w.next()).done);p=!0){var k=g.value;this.emit("removeListener",d,k)}}catch(e){_=!0,b=e}finally{try{!p&&w.return&&w.return()}finally{if(_)throw b}}}}catch(e){c=!0,f=e}finally{try{!u&&h.return&&h.return()}finally{if(c)throw f}}}return this}},{key:"emit",value:function(e){e=String(e);var t=this._events.get(e);t=Array.isArray(t)?t.concat([]):[];for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];if("error"===e&&!t.length)throw n[0]instanceof Error?n[0]:new Error("Uncaught, unspecified 'error' event. ("+n[0]+")");if(!t.length)return!1;var a=!0,s=!1,o=void 0;try{for(var l,u=t[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var c,f=l.value;f=f.wrapped_callback||f,(c=f).call.apply(c,[this].concat(n))}}catch(e){s=!0,o=e}finally{try{!a&&u.return&&u.return()}finally{if(s)throw o}}return!0}},{key:"eventNames",value:function(){return Array.from(this._events.entries()).filter(function(e){return Array.isArray(e[1])&&e[1].length}).map(function(e){return e[0]})}},{key:"listeners",value:function(e){e=String(e);var t=this._events.get(e);return t=Array.isArray(t)?t.concat([]):[],t=t.map(function(e){return e.callback||e})}},{key:"listenerCount",value:function(e){e=String(e);var t=this._events.get(e);return Array.isArray(t)?t.length:0}},{key:"getMaxListeners",value:function(){return this._max_listeners}},{key:"setMaxListeners",value:function(e){if(isNaN(e)||"number"!=typeof e||e<0)throw new TypeError("'n' argument must be a positive number");return this._max_listeners=Number(e),this}}],[{key:"defaultMaxListeners",get:function(){return 10}}]),e}();